<!DOCTYPE html>
<html lang="en"><head>
<script src="CSS Workshop_revised4_files/libs/clipboard/clipboard.min.js"></script>
<script src="CSS Workshop_revised4_files/libs/quarto-html/tabby.min.js"></script>
<script src="CSS Workshop_revised4_files/libs/quarto-html/popper.min.js"></script>
<script src="CSS Workshop_revised4_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="CSS Workshop_revised4_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="CSS Workshop_revised4_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="CSS Workshop_revised4_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="CSS Workshop_revised4_files/libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="CSS Workshop_revised4_files/libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="CSS Workshop_revised4_files/libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="KT Wong">
  <meta name="dcterms.date" content="2025-06-27">
  <title>CSS Workshop</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="CSS Workshop_revised4_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="CSS Workshop_revised4_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="CSS Workshop_revised4_files/libs/revealjs/dist/theme/quarto-62269a4027e1e91a82b4bdcec2ee27ab.css">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="CSS Workshop_revised4_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <style>
  #title-slide .abstract {
    font-size: 28px;
    color: #F15D50;
  }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">CSS Workshop</h1>
  <p class="subtitle">Some tastes on Computational Social Sciences</p>
  <p class="author">KT Wong</p>


  <p class="email" style="font-style: italic; font-size: smaller; margin-top: 0;">kwanto@hku.hk</p>

  <p class="affiliation" style="font-style: italic; font-size: smaller; margin-top: 0;">Faculty of Social Sciences, HKU</p>

  <p class="date">2025-06-27</p>

</section>
<section>
<section id="monty-hall-game" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Monty Hall Game</h1>

</section>
<section id="some-background-about-monty-hall-game" class="slide level2">
<h2>Some background about Monty Hall Game</h2>
<ul>
<li class="fragment"><p>Based on the American television game show <strong>Let’s Make a Deal</strong> and its host, named <code>Monty Hall</code></p></li>
<li class="fragment"><p>The game involves three doors</p>
<ul>
<li class="fragment">behind one of which is a <strong>car</strong> (the prize)</li>
<li class="fragment">behind the other two are <strong>goats</strong> (not the prize)</li>
</ul></li>
<li class="fragment"><p>You pick a door — say, door 1</p></li>
<li class="fragment"><p>Now, the host, who knows what’s behind the doors, opens one of the other doors — say, door 2 — which reveals a goat</p></li>
<li class="fragment"><p>The host then asks you:</p>
<ul>
<li class="fragment">Do you want to stay with door 1, or</li>
<li class="fragment">would you like to switch to door 3?</li>
</ul></li>
<li class="fragment"><p>What should you do?</p></li>
</ul>
<aside class="notes">
<ul>
<li>A bit more information about the game <iframe data-external="1" src="https://www.youtube.com/embed/C4vRTzsv4os" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="use-a-computational-method-to-simulate-the-monty-hall-game" class="slide level2">
<h2>Use a computational method to simulate the Monty Hall game</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Simulate the Monty Hall game</span></span>
<span id="cb1-2"><a href=""></a>doors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Door 1"</span>, <span class="st">"Door 2"</span>, <span class="st">"Door 3"</span>)</span>
<span id="cb1-3"><a href=""></a></span>
<span id="cb1-4"><a href=""></a>win_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href=""></a></span>
<span id="cb1-6"><a href=""></a>n<span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of simulations</span></span>
<span id="cb1-7"><a href=""></a></span>
<span id="cb1-8"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb1-9"><a href=""></a>  <span class="co"># Randomly place the car behind one of the doors</span></span>
<span id="cb1-10"><a href=""></a>  car_door <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-11"><a href=""></a>  </span>
<span id="cb1-12"><a href=""></a>  <span class="co"># Player randomly chooses a door</span></span>
<span id="cb1-13"><a href=""></a>  player_choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-14"><a href=""></a>  </span>
<span id="cb1-15"><a href=""></a>  <span class="co"># Check if the player wins by staying with their choice</span></span>
<span id="cb1-16"><a href=""></a>  <span class="cf">if</span> (player_choice <span class="sc">==</span> car_door) {</span>
<span id="cb1-17"><a href=""></a>    win_count <span class="ot">&lt;-</span> win_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-18"><a href=""></a>  }</span>
<span id="cb1-19"><a href=""></a>}</span>
<span id="cb1-20"><a href=""></a></span>
<span id="cb1-21"><a href=""></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"the Probability of Winning by NOT switching:"</span>, win_count<span class="sc">/</span>n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "the Probability of Winning by NOT switching: 0.3381"</code></pre>
</div>
</div>
</section>
<section id="the-scenario-of-switching-a-door" class="slide level2">
<h2>the scenario of switching a door</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>win_count_switch <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-2"><a href=""></a></span>
<span id="cb3-3"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb3-4"><a href=""></a>  <span class="co"># Randomly place the car behind one of the doors</span></span>
<span id="cb3-5"><a href=""></a>  car_door <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-6"><a href=""></a>  </span>
<span id="cb3-7"><a href=""></a>  <span class="co"># Player randomly chooses a door</span></span>
<span id="cb3-8"><a href=""></a>  player_choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-9"><a href=""></a>  </span>
<span id="cb3-10"><a href=""></a>  <span class="co"># Host opens a door that is not the player's choice and does not have the car</span></span>
<span id="cb3-11"><a href=""></a>  remaining_doors <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(doors, <span class="fu">c</span>(player_choice, car_door))</span>
<span id="cb3-12"><a href=""></a>  host_opens <span class="ot">&lt;-</span> <span class="fu">sample</span>(remaining_doors, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-13"><a href=""></a>  </span>
<span id="cb3-14"><a href=""></a>  <span class="co"># The player switches to the remaining closed door</span></span>
<span id="cb3-15"><a href=""></a>  switch_choice <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(doors, <span class="fu">c</span>(player_choice, host_opens))</span>
<span id="cb3-16"><a href=""></a>  </span>
<span id="cb3-17"><a href=""></a>  <span class="co"># Check if the player wins by switching</span></span>
<span id="cb3-18"><a href=""></a>  <span class="cf">if</span> (switch_choice <span class="sc">==</span> car_door) {</span>
<span id="cb3-19"><a href=""></a>    win_count_switch <span class="ot">&lt;-</span> win_count_switch <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-20"><a href=""></a>  }</span>
<span id="cb3-21"><a href=""></a>}</span>
<span id="cb3-22"><a href=""></a></span>
<span id="cb3-23"><a href=""></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"the Probability of Winning by switching:"</span>, win_count_switch<span class="sc">/</span>n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "the Probability of Winning by switching: 0.6699"</code></pre>
</div>
</div>
</section>
<section id="write-a-function-to-simulate-the-monty-hall-game" class="slide level2">
<h2>Write a function to simulate the Monty Hall game</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>monty_hall <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">d =</span> <span class="dv">3</span>, <span class="at">switch =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb5-2"><a href=""></a>  </span>
<span id="cb5-3"><a href=""></a>  prize <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb5-4"><a href=""></a>  </span>
<span id="cb5-5"><a href=""></a>  choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)    </span>
<span id="cb5-6"><a href=""></a>  </span>
<span id="cb5-7"><a href=""></a>  host_choices <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="fu">c</span>(choice, prize))</span>
<span id="cb5-8"><a href=""></a>  host_open <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(host_choices) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">sample</span>(host_choices, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="cf">else</span> host_choices</span>
<span id="cb5-9"><a href=""></a>  </span>
<span id="cb5-10"><a href=""></a>  <span class="cf">if</span>(<span class="cf">switch</span>) {</span>
<span id="cb5-11"><a href=""></a>    remaining <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="fu">c</span>(choice, host_open))</span>
<span id="cb5-12"><a href=""></a>    final_choice <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(remaining) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">sample</span>(remaining, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="cf">else</span> remaining</span>
<span id="cb5-13"><a href=""></a>  } <span class="cf">else</span> {</span>
<span id="cb5-14"><a href=""></a>    final_choice <span class="ot">&lt;-</span> choice</span>
<span id="cb5-15"><a href=""></a>  }</span>
<span id="cb5-16"><a href=""></a>  </span>
<span id="cb5-17"><a href=""></a>  win <span class="ot">&lt;-</span> final_choice <span class="sc">==</span> prize</span>
<span id="cb5-18"><a href=""></a>  <span class="fu">return</span>(win)</span>
<span id="cb5-19"><a href=""></a>  </span>
<span id="cb5-20"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulate-and-plot-the-probability-of-winning-by-switching" class="slide level2">
<h2>simulate and plot the probability of winning by switching</h2>
<ul>
<li class="fragment">Simulate the Monty Hall game for different numbers of rounds</li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href=""></a>rounds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>, <span class="dv">50000</span>)</span>
<span id="cb6-3"><a href=""></a></span>
<span id="cb6-4"><a href=""></a>prob_switch <span class="ot">&lt;-</span> <span class="fu">sapply</span>(rounds, <span class="cf">function</span>(r) {</span>
<span id="cb6-5"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(r, <span class="fu">monty_hall</span>(<span class="at">switch =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb6-6"><a href=""></a>})</span>
<span id="cb6-7"><a href=""></a></span>
<span id="cb6-8"><a href=""></a>prob_stay <span class="ot">&lt;-</span> <span class="fu">sapply</span>(rounds, <span class="cf">function</span>(r) {</span>
<span id="cb6-9"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(r, <span class="fu">monty_hall</span>(<span class="at">switch =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb6-10"><a href=""></a>})</span>
<span id="cb6-11"><a href=""></a></span>
<span id="cb6-12"><a href=""></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-13"><a href=""></a>  <span class="at">rounds =</span> <span class="fu">rep</span>(rounds, <span class="dv">2</span>),</span>
<span id="cb6-14"><a href=""></a>  <span class="at">probability =</span> <span class="fu">c</span>(prob_switch, prob_stay),</span>
<span id="cb6-15"><a href=""></a>  <span class="at">strategy =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Switch"</span>, <span class="st">"Stay"</span>), <span class="at">each =</span> <span class="fu">length</span>(rounds))</span>
<span id="cb6-16"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">Plot the probabilities of winning by switching and staying</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href=""></a></span>
<span id="cb7-3"><a href=""></a><span class="fu">ggplot</span>(df, </span>
<span id="cb7-4"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> rounds, <span class="at">y =</span> probability, <span class="at">color =</span> strategy)) <span class="sc">+</span></span>
<span id="cb7-5"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-6"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-7"><a href=""></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb7-8"><a href=""></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href=""></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">max</span>(rounds), <span class="at">y =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">label =</span> <span class="st">"2/3"</span>), </span>
<span id="cb7-10"><a href=""></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># Annotate 2/3</span></span>
<span id="cb7-11"><a href=""></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">max</span>(rounds), <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">label =</span> <span class="st">"1/3"</span>), </span>
<span id="cb7-12"><a href=""></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>   <span class="co"># Annotate 1/3</span></span>
<span id="cb7-13"><a href=""></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks=</span>rounds, <span class="at">labels=</span>rounds) <span class="sc">+</span></span>
<span id="cb7-14"><a href=""></a>  <span class="fu">scale_color_discrete</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"Stay"</span>, <span class="st">"Switch"</span>)) <span class="sc">+</span>  <span class="co"># Reorder legend labels</span></span>
<span id="cb7-15"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Convergence of Monty Hall Probabilities"</span>,</span>
<span id="cb7-16"><a href=""></a>       <span class="at">subtitle =</span> <span class="st">"Dotted lines: Theoretical values (Switch=2/3, Stay=1/3)"</span>,</span>
<span id="cb7-17"><a href=""></a>       <span class="at">x =</span> <span class="st">"Number of Rounds (log scale)"</span>, <span class="at">y =</span> <span class="st">"Probability of Winning"</span>,</span>
<span id="cb7-18"><a href=""></a>       <span class="at">color =</span> <span class="st">"Strategy Choice"</span>)<span class="sc">+</span></span>
<span id="cb7-19"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-20"><a href=""></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(rounds), <span class="fu">max</span>(rounds) <span class="sc">*</span> <span class="fl">1.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-5-1.png" width="1152"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li><p>scale_color_discrete(breaks = c(“Stay”, “Switch”), labels = c(“Keep”, “Change”)) + # Rename legend labels</p></li>
<li><p>The Monty Hall problem illustrates how people rely on flawed heuristics when faced with probabilistic decisions</p></li>
<li><p>Many initially assume the probability is 50-50 after Monty reveals a goat</p>
<ul>
<li>reflecting an equal probability heuristic or availability bias</li>
<li>focusing on the two remaining doors without considering Monty’s deliberate action</li>
</ul></li>
<li><p>Application in Social Sciences:</p>
<ul>
<li>Psychology: Studies on cognitive biases, such as the anchoring effect (sticking to the initial choice) or confirmation bias (ignoring Monty’s informative action), can use the Monty Hall problem to explore why people resist switching despite mathematical evidence</li>
<li>Behavioral Economics: The problem highlights deviations from rational choice theory, informing models of bounded rationality. Researchers can investigate how framing (e.g., emphasizing the $ $ chance) affects decision-making</li>
<li>Example: Experiments can test whether explaining the problem with analogies (e.g., 100 doors instead of 3) reduces the bias against switching, shedding light on how to debias decision-making in policy or financial contexts</li>
</ul></li>
<li><p>The Monty Hall problem is a controlled scenario for studying how people make decisions under uncertainty, especially when new information (Monty’s reveal) requires updating beliefs. It shows that people often fail to incorporate conditional probabilities correctly.</p></li>
<li><p>Application in Social Sciences:</p>
<ul>
<li>Economics and Game Theory: The problem can model real-world scenarios where new information (e.g., market signals, policy changes) should prompt belief updating, but agents stick to initial choices due to inertia or misjudgment.</li>
<li>Political Science: Voters may cling to initial candidate preferences despite new evidence (e.g., scandals or policy shifts), akin to “staying” with Door 1. Researchers can study how campaign messaging influences belief updating.</li>
<li>Example: Surveys or lab experiments can present Monty Hall-like scenarios to test how training in Bayesian reasoning improves decision-making in uncertain environments, such as medical diagnoses or legal judgments</li>
</ul></li>
<li><p>The Monty Hall problem is a textbook case for applying Bayes’ rule, showing how conditional probabilities (e.g., $ P( | ) = $) should guide decisions. Most people struggle with this, preferring intuitive over analytical thinking.</p></li>
<li><p>Application in Social Sciences:</p>
<ul>
<li>Sociology: Researchers can study how groups update beliefs based on new evidence, such as public health campaigns or misinformation correction, and why resistance persists (e.g., vaccine hesitancy).</li>
<li>Psychology: The problem can test interventions to improve statistical literacy, crucial for interpreting risks in health, finance, or climate change.</li>
<li>Example: A study could compare groups trained in Bayesian reasoning versus controls in Monty Hall tasks, then extend findings to real-world scenarios like jury deliberations, where jurors must update beliefs based on evidence.</li>
</ul></li>
<li><p>The Monty Hall problem underscores the importance of understanding conditional probabilities in experimental design. Misinterpreting probabilities can lead to flawed research conclusions, especially in studies involving sequential or conditional events.</p></li>
<li><p>Application in Social Sciences:</p>
<ul>
<li>Methodological Rigor: Researchers must account for conditional dependencies in observational or experimental data (e.g., treatment effects conditional on covariates). The Monty Hall problem serves as a cautionary tale against intuitive assumptions.</li>
<li>Education: Teaching the problem in social science methods courses can improve statistical literacy among researchers, ensuring better interpretation of p-values, confidence intervals, or causal inference.</li>
<li>Example: In survey experiments, researchers might misinterpret responses if they ignore conditional events (e.g., how prior exposure to a stimulus affects answers). The Monty Hall problem can guide training on proper probability calculation</li>
</ul></li>
<li><p>The counterintuitive nature of the Monty Hall solution often leads people to distrust mathematical explanations, even when presented by experts. This mirrors real-world skepticism toward scientific or statistical findings.</p></li>
<li><p>Application in Social Sciences:</p>
<ul>
<li>Communication Studies: The problem can inform strategies for communicating complex probabilistic information to the public, such as climate risks or epidemiological models.</li>
<li>Public Policy: Understanding why people reject expert advice (e.g., “switching feels wrong”) can improve policy design, especially in areas requiring trust, like vaccination or economic reforms.</li>
<li>Example: Experiments can test whether framing expert advice in relatable terms (e.g., using simulations or visualizations of Monty Hall) increases public acceptance of counterintuitive findings, such as tax policy impacts.</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="extension-1-number-of-doors" class="slide level2">
<h2>Extension 1: Number of doors</h2>
<ul>
<li class="fragment">Let us see how the probability of winning by switching changes as the number of doors increases</li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>doors <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb8-2"><a href=""></a>sim_per_door <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb8-3"><a href=""></a></span>
<span id="cb8-4"><a href=""></a>prob_switch_by_doors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(doors, <span class="cf">function</span>(n) {</span>
<span id="cb8-5"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(sim_per_door, <span class="fu">monty_hall</span>(<span class="at">d =</span> n, <span class="at">switch =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb8-6"><a href=""></a>})</span>
<span id="cb8-7"><a href=""></a></span>
<span id="cb8-8"><a href=""></a>prob_stay_by_doors <span class="ot">&lt;-</span> <span class="fu">sapply</span>(doors, <span class="cf">function</span>(n) {</span>
<span id="cb8-9"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(sim_per_door, <span class="fu">monty_hall</span>(<span class="at">d =</span> n, <span class="at">switch =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb8-10"><a href=""></a>})</span>
<span id="cb8-11"><a href=""></a></span>
<span id="cb8-12"><a href=""></a></span>
<span id="cb8-13"><a href=""></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-14"><a href=""></a>  <span class="at">doors =</span> <span class="fu">rep</span>(doors, <span class="dv">2</span>),</span>
<span id="cb8-15"><a href=""></a>  <span class="at">probability =</span> <span class="fu">c</span>(prob_switch_by_doors, prob_stay_by_doors),</span>
<span id="cb8-16"><a href=""></a>  <span class="at">strategy =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Switch"</span>, <span class="st">"Stay"</span>), <span class="at">each =</span> <span class="fu">length</span>(doors))</span>
<span id="cb8-17"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">ggplot</span>(df2, </span>
<span id="cb9-2"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> doors, <span class="at">y =</span> probability, <span class="at">color =</span> strategy)) <span class="sc">+</span></span>
<span id="cb9-3"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href=""></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(df2, doors <span class="sc">==</span> <span class="fu">min</span>(df2<span class="sc">$</span>doors)), </span>
<span id="cb9-6"><a href=""></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, probability), </span>
<span id="cb9-7"><a href=""></a>                <span class="at">vjust =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"Switch"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)), </span>
<span id="cb9-8"><a href=""></a>            <span class="at">hjust =</span> <span class="fl">1.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Annotate min(doors)</span></span>
<span id="cb9-9"><a href=""></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(df2, doors <span class="sc">==</span> <span class="fu">max</span>(df2<span class="sc">$</span>doors)), </span>
<span id="cb9-10"><a href=""></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, probability), </span>
<span id="cb9-11"><a href=""></a>                <span class="at">vjust =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"Switch"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)), </span>
<span id="cb9-12"><a href=""></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="co"># Annotate max(doors)</span></span>
<span id="cb9-13"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-14"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monty Hall Probabilities with More Doors"</span>,</span>
<span id="cb9-15"><a href=""></a>       <span class="at">x =</span> <span class="st">"Number of Doors"</span>, </span>
<span id="cb9-16"><a href=""></a>       <span class="at">y =</span> <span class="st">"Probability of Winning"</span>,</span>
<span id="cb9-17"><a href=""></a>       <span class="at">color =</span> <span class="st">"Strategy Choice"</span>) <span class="sc">+</span></span>
<span id="cb9-18"><a href=""></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(doors)<span class="sc">-</span><span class="fl">0.5</span>, <span class="fu">max</span>(doors)<span class="sc">+</span><span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-7-1.png" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="extension-2-number-of-open-doors" class="slide level2">
<h2>Extension 2: Number of Open doors</h2>
<ul>
<li class="fragment"><p>Let us see how the probability of winning by switching changes as the number of open doors increases</p></li>
<li class="fragment"><p>Let there be 50 doors; you select one, and Monty Hall opens either 1 or 2 or …, 48 remaining doors</p></li>
<li class="fragment"><p>Modify the functions</p></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a>monty_hall_v2 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">d =</span> <span class="dv">50</span>, <span class="at">open=</span><span class="dv">1</span>, <span class="at">switch =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb10-2"><a href=""></a>  </span>
<span id="cb10-3"><a href=""></a>  prize <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb10-4"><a href=""></a>  </span>
<span id="cb10-5"><a href=""></a>  choice <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)    </span>
<span id="cb10-6"><a href=""></a>  </span>
<span id="cb10-7"><a href=""></a>  host_choices <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="fu">c</span>(choice, prize))</span>
<span id="cb10-8"><a href=""></a>  host_open <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(host_choices) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">sample</span>(host_choices, open, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="cf">else</span> host_choices</span>
<span id="cb10-9"><a href=""></a>  </span>
<span id="cb10-10"><a href=""></a>  <span class="cf">if</span>(<span class="cf">switch</span>) {</span>
<span id="cb10-11"><a href=""></a>    remaining <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="fu">c</span>(choice, host_open))</span>
<span id="cb10-12"><a href=""></a>    final_choice <span class="ot">&lt;-</span> <span class="cf">if</span>(<span class="fu">length</span>(remaining) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="fu">sample</span>(remaining, <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="cf">else</span> remaining</span>
<span id="cb10-13"><a href=""></a>  } <span class="cf">else</span> {</span>
<span id="cb10-14"><a href=""></a>    final_choice <span class="ot">&lt;-</span> choice</span>
<span id="cb10-15"><a href=""></a>  }</span>
<span id="cb10-16"><a href=""></a>  </span>
<span id="cb10-17"><a href=""></a>  win <span class="ot">&lt;-</span> final_choice <span class="sc">==</span> prize</span>
<span id="cb10-18"><a href=""></a>  <span class="fu">return</span>(win)</span>
<span id="cb10-19"><a href=""></a>  </span>
<span id="cb10-20"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">simulate the Monty Hall game for different numbers of open doors</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>open_doors <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">48</span></span>
<span id="cb11-2"><a href=""></a></span>
<span id="cb11-3"><a href=""></a>sim_per_open <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-4"><a href=""></a></span>
<span id="cb11-5"><a href=""></a>prob_switch_by_open <span class="ot">&lt;-</span> <span class="fu">sapply</span>(open_doors, <span class="cf">function</span>(n) {</span>
<span id="cb11-6"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(sim_per_open, <span class="fu">monty_hall_v2</span>(<span class="at">open =</span> n, <span class="at">switch =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb11-7"><a href=""></a>})</span>
<span id="cb11-8"><a href=""></a></span>
<span id="cb11-9"><a href=""></a>prob_stay_by_open <span class="ot">&lt;-</span> <span class="fu">sapply</span>(open_doors, <span class="cf">function</span>(n) {</span>
<span id="cb11-10"><a href=""></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(sim_per_open, <span class="fu">monty_hall_v2</span>(<span class="at">open =</span> n, <span class="at">switch =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb11-11"><a href=""></a>})</span>
<span id="cb11-12"><a href=""></a></span>
<span id="cb11-13"><a href=""></a>df3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-14"><a href=""></a>  <span class="at">open_doors =</span> <span class="fu">rep</span>(open_doors, <span class="dv">2</span>),</span>
<span id="cb11-15"><a href=""></a>  <span class="at">probability =</span> <span class="fu">c</span>(prob_switch_by_open, prob_stay_by_open),</span>
<span id="cb11-16"><a href=""></a>  <span class="at">strategy =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Switch"</span>, <span class="st">"Stay"</span>), <span class="at">each =</span> <span class="fu">length</span>(open_doors))</span>
<span id="cb11-17"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">plot the probabilities of winning by switching and staying</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="fu">ggplot</span>(df3, </span>
<span id="cb12-2"><a href=""></a>       <span class="fu">aes</span>(<span class="at">x =</span> open_doors, <span class="at">y =</span> probability, <span class="at">color =</span> strategy)) <span class="sc">+</span></span>
<span id="cb12-3"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href=""></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(df3, open_doors <span class="sc">==</span> <span class="fu">min</span>(df3<span class="sc">$</span>open_doors)), </span>
<span id="cb12-6"><a href=""></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, probability), </span>
<span id="cb12-7"><a href=""></a>                <span class="at">vjust =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"Switch"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)), </span>
<span id="cb12-8"><a href=""></a>                <span class="at">hjust =</span> <span class="fl">1.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-9"><a href=""></a>                <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Annotate min(open_doors)</span></span>
<span id="cb12-10"><a href=""></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(df3, open_doors <span class="sc">==</span> <span class="fu">max</span>(df3<span class="sc">$</span>open_doors)), </span>
<span id="cb12-11"><a href=""></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, probability), </span>
<span id="cb12-12"><a href=""></a>                <span class="at">vjust =</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"Switch"</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>)), </span>
<span id="cb12-13"><a href=""></a>                <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-14"><a href=""></a>                <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Annotate max(open_doors)</span></span>
<span id="cb12-15"><a href=""></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-16"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Monty Hall Probabilities with More Open Doors"</span>,</span>
<span id="cb12-17"><a href=""></a>       <span class="at">x =</span> <span class="st">"Number of Open Doors"</span>, </span>
<span id="cb12-18"><a href=""></a>       <span class="at">y =</span> <span class="st">"Probability of Winning"</span>,</span>
<span id="cb12-19"><a href=""></a>       <span class="at">color =</span> <span class="st">"Strategy Choice"</span>) <span class="sc">+</span></span>
<span id="cb12-20"><a href=""></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(open_doors)<span class="sc">-</span><span class="dv">2</span>, <span class="fu">max</span>(open_doors)<span class="sc">+</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-10-1.png" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="expansion-of-walmart" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Expansion of Walmart</h1>
<ul>
<li class="fragment"><p>Walmart opened its first store in 1962 in Rogers, Arkansas, United States</p></li>
<li class="fragment"><p>Over the next several decades, it opened many stores within the United States and then around the world</p></li>
<li class="fragment"><p>Walmart has become one of the largest retail multinational companies in the world</p></li>
<li class="fragment"><p>This data set contains spatial and temporal information about Walmart store openings from the first opening on March 1, 1962 until August 1, 2006</p></li>
<li class="fragment"><p>three different types of stores, represented by the variable <strong>type</strong></p>
<ul>
<li class="fragment">Wal-MartStore represents a standard Walmart store</li>
<li class="fragment">SuperCenter is a standard Walmart store as well as a full supermarket
<ul>
<li class="fragment">it often include pharmacies, garden shops, car service centers, and other specialty centers</li>
</ul></li>
<li class="fragment">DistributionCenter - distributes foods and goods to standard Walmart stores and Supercenters</li>
</ul></li>
</ul>
</section>
<section id="data-set" class="slide level2">
<h2>Data set</h2>
<ul>
<li class="fragment">The data set contains the following variables:
<ul>
<li class="fragment">opendate: Opening date for the store</li>
<li class="fragment">st.address: Street address of the store</li>
<li class="fragment">city: City of the store</li>
<li class="fragment">state: State of the store</li>
<li class="fragment">type: Store type (Wal-MartStore, SuperCenter, DistributionCenter)</li>
<li class="fragment">lat: latitude of the store location</li>
<li class="fragment">long: longitude of the store location</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb13-2"><a href=""></a></span>
<span id="cb13-3"><a href=""></a>walmart<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/kwan-MSDA/Bootcamp_2024/refs/heads/main/dataset/walmart.csv"</span>)</span>
<span id="cb13-4"><a href=""></a></span>
<span id="cb13-5"><a href=""></a></span>
<span id="cb13-6"><a href=""></a>walmart <span class="ot">&lt;-</span> walmart <span class="sc">%&gt;%</span></span>
<span id="cb13-7"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">recode</span>(type,</span>
<span id="cb13-8"><a href=""></a>                       <span class="st">"DistributionCenter"</span> <span class="ot">=</span> <span class="st">"Distribution </span><span class="sc">\n</span><span class="st">center"</span>,</span>
<span id="cb13-9"><a href=""></a>                       <span class="st">"SuperCenter"</span> <span class="ot">=</span> <span class="st">"Supercenter"</span>,</span>
<span id="cb13-10"><a href=""></a>                       <span class="st">"Wal-MartStore"</span> <span class="ot">=</span> <span class="st">"Walmart"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">size =</span> <span class="fu">if_else</span>(type <span class="sc">==</span> <span class="st">"Distribution </span><span class="sc">\n</span><span class="st">center"</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="map-the-location-of-walmart-stores" class="slide level2">
<h2>Map the location of Walmart stores</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">library</span>(maps)</span>
<span id="cb14-2"><a href=""></a></span>
<span id="cb14-3"><a href=""></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href=""></a>  <span class="fu">borders</span>(<span class="at">database =</span> <span class="st">"state"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb14-6"><a href=""></a>                 <span class="at">color =</span> type, <span class="at">size =</span> size),</span>
<span id="cb14-7"><a href=""></a>             <span class="at">data =</span> walmart, </span>
<span id="cb14-8"><a href=""></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb14-9"><a href=""></a>  <span class="fu">coord_quickmap</span>() <span class="sc">+</span></span>
<span id="cb14-10"><a href=""></a>  <span class="fu">scale_size_identity</span>() <span class="sc">+</span></span>
<span id="cb14-11"><a href=""></a>  <span class="fu">theme_void</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="co"># remove all extra formatting</span></span>
<span id="cb14-12"><a href=""></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Type"</span>) <span class="co"># change the label for the legend</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-12-1.png" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li><p>map the location of the Walmart stores</p>
<ul>
<li>use the borders() function to add the borders of the states</li>
<li>use the geom_point() function to plot the points based on their latitude and longitude</li>
<li>use the size aesthetic to control the size of the points based on the type of store</li>
<li>use the scale_size_identity() function to ensure that the size is taken directly from the data set</li>
<li>use the coord_quickmap() function to ensure that the map is plotted correctly</li>
<li>use the theme_void() function to remove all extra formatting from the plot</li>
</ul></li>
<li><p>The map clearly shows the business strategy of Walmart</p></li>
<li><p>While Supercenters are widespread throughout the Midwest and South, they appear less prevalent in the Northeast and the West Coast, as well as in urban centers more generally</p></li>
<li><p>In these areas, Walmart has chosen not to expand past the standard discount store format</p>
<ul>
<li>(or at least that was the case when the data were collected)</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="plotting-over-time" class="slide level2">
<h2>Plotting over time</h2>
<ul>
<li class="fragment"><p>The data set contains the opening date of each store, so we can make the maps to show how Walmart expanded over time</p></li>
<li class="fragment"><p>useful to define a function that subsets the data given a specified date</p></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-2"><a href=""></a><span class="fu">library</span>(lubridate)</span>
<span id="cb15-3"><a href=""></a></span>
<span id="cb15-4"><a href=""></a>walmart.map <span class="ot">&lt;-</span> <span class="cf">function</span>(data, date, <span class="at">show_legend =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb15-5"><a href=""></a>  temp <span class="ot">&lt;-</span> <span class="fu">filter</span>(data, opendate <span class="sc">&lt;=</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb15-6"><a href=""></a>    <span class="fu">mutate</span>(<span class="at">size =</span> <span class="fu">if_else</span>(type <span class="sc">==</span> <span class="st">"Distribution </span><span class="sc">\n</span><span class="st">center"</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb15-7"><a href=""></a>  </span>
<span id="cb15-8"><a href=""></a></span>
<span id="cb15-9"><a href=""></a>  p<span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-10"><a href=""></a>    <span class="fu">borders</span>(<span class="at">database =</span> <span class="st">"state"</span>) <span class="sc">+</span></span>
<span id="cb15-11"><a href=""></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> temp,</span>
<span id="cb15-12"><a href=""></a>               <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">color =</span> type, <span class="at">size =</span> size),</span>
<span id="cb15-13"><a href=""></a>               <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb15-14"><a href=""></a>    <span class="fu">coord_quickmap</span>() <span class="sc">+</span></span>
<span id="cb15-15"><a href=""></a>    <span class="fu">scale_size_identity</span>() <span class="sc">+</span></span>
<span id="cb15-16"><a href=""></a>    <span class="fu">theme_void</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb15-17"><a href=""></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Type"</span>) <span class="sc">+</span></span>
<span id="cb15-18"><a href=""></a>    <span class="fu">ggtitle</span>(<span class="fu">year</span>(date))</span>
<span id="cb15-19"><a href=""></a>  </span>
<span id="cb15-20"><a href=""></a>  <span class="cf">if</span> (show_legend) {</span>
<span id="cb15-21"><a href=""></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>, <span class="at">legend.direction =</span> <span class="st">"horizontal"</span>) <span class="sc">+</span></span>
<span id="cb15-22"><a href=""></a>      <span class="fu">guides</span>(<span class="at">size =</span> <span class="st">"none"</span>)  <span class="co"># Suppress size legend, keep only color legend</span></span>
<span id="cb15-23"><a href=""></a>  } </span>
<span id="cb15-24"><a href=""></a>  <span class="cf">else</span> {</span>
<span id="cb15-25"><a href=""></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb15-26"><a href=""></a>  }</span>
<span id="cb15-27"><a href=""></a>  </span>
<span id="cb15-28"><a href=""></a>  <span class="fu">return</span>(p)</span>
<span id="cb15-29"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">create a map for every ten years</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="fu">library</span>(grid)</span>
<span id="cb16-2"><a href=""></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb16-3"><a href=""></a><span class="fu">library</span>(patchwork)</span>
<span id="cb16-4"><a href=""></a></span>
<span id="cb16-5"><a href=""></a>p1<span class="ot">&lt;-</span> <span class="fu">walmart.map</span>(walmart, <span class="fu">as.Date</span>(<span class="st">"1974-12-31"</span>), <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-6"><a href=""></a>p2<span class="ot">&lt;-</span> <span class="fu">walmart.map</span>(walmart, <span class="fu">as.Date</span>(<span class="st">"1984-12-31"</span>), <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-7"><a href=""></a>p3<span class="ot">&lt;-</span> <span class="fu">walmart.map</span>(walmart, <span class="fu">as.Date</span>(<span class="st">"1994-12-31"</span>), <span class="at">show_legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-8"><a href=""></a>p4<span class="ot">&lt;-</span> <span class="fu">walmart.map</span>(walmart, <span class="fu">as.Date</span>(<span class="st">"2004-12-31"</span>), <span class="at">show_legend =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-9"><a href=""></a></span>
<span id="cb16-10"><a href=""></a><span class="co"># Combine plots in a 2x2 grid with a shared legend and main title</span></span>
<span id="cb16-11"><a href=""></a><span class="co"># Combine plots in a 2x2 grid with a shared legend and main title</span></span>
<span id="cb16-12"><a href=""></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) <span class="sc">+</span></span>
<span id="cb16-13"><a href=""></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>, <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb16-14"><a href=""></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb16-15"><a href=""></a>    <span class="at">title =</span> <span class="st">"Walmart Store Openings by Year"</span>,</span>
<span id="cb16-16"><a href=""></a>    <span class="at">caption =</span> <span class="st">""</span>  <span class="co"># Optional: ensures no extra caption interferes</span></span>
<span id="cb16-17"><a href=""></a>  ) <span class="sc">&amp;</span> </span>
<span id="cb16-18"><a href=""></a>  <span class="fu">theme</span>(</span>
<span id="cb16-19"><a href=""></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb16-20"><a href=""></a>    <span class="at">legend.direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb16-21"><a href=""></a>    <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>),</span>
<span id="cb16-22"><a href=""></a>    <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">2</span>, <span class="at">r =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">2</span>), <span class="co"># space above legend</span></span>
<span id="cb16-23"><a href=""></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">18</span>, </span>
<span id="cb16-24"><a href=""></a>                              <span class="at">face =</span> <span class="st">"bold"</span>, </span>
<span id="cb16-25"><a href=""></a>                              <span class="at">margin=</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)) <span class="co"># space below title </span></span>
<span id="cb16-26"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-14-1.png" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li>The previous analysis of Walmart store openings ignored the temporal dimension
<ul>
<li>even though the data set contains the opening date. By examining the spatial–temporal patterns rather than spatial patterns alone, we can better understand how Walmart expanded its stores over time</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="animation" class="slide level2">
<h2>Animation</h2>
<ul>
<li class="fragment">The <strong>gganimate</strong> package allows us to create animations within a ggplot framework
<ul>
<li class="fragment">An animation is essentially a series of static images shown one after the other</li>
<li class="fragment">use the <strong>transition_states()</strong> function to create a series of plots</li>
</ul></li>
<li class="fragment">plot the expansion of Walmart by year
<ul>
<li class="fragment">create a new variable in the data called <span class="math inline">\(year\)</span></li>
<li class="fragment">within <strong>transition_states()</strong> function we specify the new <strong>year</strong> variable as the states argument</li>
</ul></li>
<li class="fragment">specify
<ul>
<li class="fragment">how long we want each state visible with the <strong>state_length</strong> argument</li>
<li class="fragment">how long we want each transition between states to last with the <strong>transition_length</strong> argument</li>
<li class="fragment">add the <strong>shadow_mark()</strong> function to keep the points from previous states visible, adding more points on top</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="fu">options</span>(<span class="at">device =</span> <span class="st">"cairo_png"</span>)</span>
<span id="cb17-2"><a href=""></a></span>
<span id="cb17-3"><a href=""></a><span class="fu">library</span>(gifski)</span>
<span id="cb17-4"><a href=""></a><span class="fu">library</span>(gganimate)</span>
<span id="cb17-5"><a href=""></a><span class="fu">library</span>(lubridate)</span>
<span id="cb17-6"><a href=""></a></span>
<span id="cb17-7"><a href=""></a><span class="do">## round down to year from opendate</span></span>
<span id="cb17-8"><a href=""></a>walmart <span class="ot">&lt;-</span> walmart <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(opendate),</span>
<span id="cb17-10"><a href=""></a>         <span class="at">year =</span> <span class="fu">factor</span>(year, <span class="at">levels =</span> <span class="fu">as.character</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(year)))))</span>
<span id="cb17-11"><a href=""></a></span>
<span id="cb17-12"><a href=""></a><span class="do">## create the animation</span></span>
<span id="cb17-13"><a href=""></a></span>
<span id="cb17-14"><a href=""></a>walmart_animated <span class="ot">&lt;-</span></span>
<span id="cb17-15"><a href=""></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> walmart) <span class="sc">+</span></span>
<span id="cb17-16"><a href=""></a>  <span class="fu">borders</span>(<span class="at">database =</span> <span class="st">"state"</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href=""></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat,</span>
<span id="cb17-18"><a href=""></a>                 <span class="at">color =</span> type,</span>
<span id="cb17-19"><a href=""></a>                 <span class="at">size =</span> <span class="fu">ifelse</span>(type<span class="sc">==</span><span class="st">"Distribution </span><span class="sc">\n</span><span class="st">center"</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb17-20"><a href=""></a>                 <span class="at">alpha=</span> <span class="fl">0.6</span>),</span>
<span id="cb17-21"><a href=""></a>                 <span class="at">show.legend =</span> <span class="fu">c</span>(<span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="cn">FALSE</span>, <span class="at">alpha=</span><span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb17-22"><a href=""></a>  <span class="fu">coord_quickmap</span>() <span class="sc">+</span></span>
<span id="cb17-23"><a href=""></a>  <span class="fu">theme_void</span>(<span class="at">base_size=</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb17-24"><a href=""></a>  <span class="fu">transition_states</span>(<span class="at">states =</span> year,</span>
<span id="cb17-25"><a href=""></a>                    <span class="at">transition_length =</span> <span class="dv">0</span>, <span class="co"># Instant transition</span></span>
<span id="cb17-26"><a href=""></a>                    <span class="at">state_length =</span> <span class="dv">1</span>) <span class="sc">+</span>   <span class="co"># 1 second per year</span></span>
<span id="cb17-27"><a href=""></a>  <span class="fu">shadow_mark</span>() <span class="sc">+</span></span>
<span id="cb17-28"><a href=""></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Year: {closest_state}"</span>) <span class="sc">+</span></span>
<span id="cb17-29"><a href=""></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Supercenter"</span> <span class="ot">=</span> <span class="st">"blue"</span>, </span>
<span id="cb17-30"><a href=""></a>                              <span class="st">"Walmart"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb17-31"><a href=""></a>                              <span class="st">"Distribution </span><span class="sc">\n</span><span class="st">center"</span> <span class="ot">=</span> <span class="st">"red"</span></span>
<span id="cb17-32"><a href=""></a>                              ),</span>
<span id="cb17-33"><a href=""></a>                     <span class="at">name=</span> <span class="st">"Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
</div>
</section>
<section id="animate-the-plot" class="slide level2">
<h2>Animate the plot</h2>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a>walmart_animated</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-16-1.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-16-1.gif" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="do">## save the animation</span></span>
<span id="cb19-2"><a href=""></a><span class="fu">anim_save</span>(<span class="at">filename=</span><span class="st">"walmart.gif"</span>, </span>
<span id="cb19-3"><a href=""></a>          <span class="at">animation =</span> walmart_animated, </span>
<span id="cb19-4"><a href=""></a>          <span class="at">width =</span> <span class="dv">1920</span>, <span class="at">height =</span> <span class="dv">1080</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<aside class="notes">
<ul>
<li><p>While watching, we see quite clearly the southern origins of the Walmart franchise and its gradual spread in the 1970s and 1980s throughout the region</p></li>
<li><p>Particularly striking is the speed of the mid-1990s expansion throughout the rest of the country, as well as when and where new distribution centers are established in anticipation of regional expansion</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section></section>
<section>
<section id="racial-segregation" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Racial Segregation</h1>

</section>
<section id="racial-segregration" class="slide level2">
<h2>Racial Segregration</h2>
<ul>
<li class="fragment"><p>In 1969, Thomas C. Schelling developed a simple but striking model of racial segregation</p>
<ul>
<li class="fragment">Schelling was awarded the 2005 Nobel Prize in Economic Sciences (joint with Robert Aumann) for his work on segregation (and other research)</li>
</ul></li>
<li class="fragment"><p>the model shows how <strong>local interactions</strong> can lead to surprising <strong>aggregate outcomes</strong></p></li>
<li class="fragment"><p>Each household has relatively mild preference for neighbors of the same race</p></li>
<li class="fragment"><p>the model predicts strongly divided neighborhoods, with high levels of segregation</p></li>
<li class="fragment"><p>extreme segregation outcomes arise even though people’s preferences are not particularly extreme</p></li>
</ul>
</section>
<section id="set-up-of-the-model" class="slide level2">
<h2>Set-up of the model</h2>
<ul>
<li class="fragment"><p>Suppose we have two types of people: white people and black people</p></li>
<li class="fragment"><p>Assume there are <span class="math inline">\(n\)</span> of each type</p></li>
<li class="fragment"><p>These people all live on a single unit square</p>
<ul>
<li class="fragment">the location of an individual is just a point <span class="math inline">\((x,y)\)</span>, where <span class="math inline">\(0 &lt; x, y &lt; 1\)</span></li>
<li class="fragment">the set of all points <span class="math inline">\((x,y)\)</span> satisfying is called the <strong>unit square</strong> (denoted by <strong>S</strong>)</li>
</ul></li>
<li class="fragment"><p>an individual is happy if 5 or more of her 10 nearest neighbors are of the same type</p>
<ul>
<li class="fragment">otherwise, she is unhappy</li>
</ul></li>
<li class="fragment"><p>Initially, individuals are mixed together (integrated)</p>
<ul>
<li class="fragment">each individual is now given the chance to stay or move</li>
<li class="fragment">each individual stays if they are happy and moves if they are unhappy</li>
</ul></li>
</ul>
<aside class="notes">
<ul>
<li><p>‘Nearest’ is in terms of Euclidean distance.</p></li>
<li><p>An important point to note is that agents are not averse to living in mixed areas.</p></li>
<li><p>They are perfectly happy if half of their neighbors are of the other color</p></li>
<li><p>In particular, we assume that the initial location of each agent is an independent draw from a bivariate uniform distribution on the unit square</p>
<ul>
<li>First their coordinate is drawn from a uniform distribution on</li>
<li>Then, independently, their coordinate is drawn from the same distribution</li>
</ul></li>
<li><p>We cycle continuously through the agents, each time allowing an unhappy agent to move</p></li>
<li><p>We continue to cycle until no one wishes to move</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="simulating-the-model" class="slide level2">
<h2>Simulating the model</h2>
<ul>
<li class="fragment">cycling through the set of all agents, each agent is now given the chance to stay or move
<ul>
<li class="fragment">continue to cycle until no one wishes to move</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="fu">library</span>(reticulate)</span>
<span id="cb20-2"><a href=""></a><span class="co">#use_python("C:/Users/ktwong/AppData/Local/Programs/Python/Python313/", required = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb21-2"><a href=""></a><span class="im">from</span> random <span class="im">import</span> uniform, seed</span>
<span id="cb21-3"><a href=""></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb21-4"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-5"><a href=""></a></span>
<span id="cb21-6"><a href=""></a><span class="kw">class</span> Agent:</span>
<span id="cb21-7"><a href=""></a></span>
<span id="cb21-8"><a href=""></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="bu">type</span>):</span>
<span id="cb21-9"><a href=""></a>        <span class="va">self</span>.<span class="bu">type</span> <span class="op">=</span> <span class="bu">type</span></span>
<span id="cb21-10"><a href=""></a>        <span class="va">self</span>.draw_location()</span>
<span id="cb21-11"><a href=""></a></span>
<span id="cb21-12"><a href=""></a>    <span class="kw">def</span> draw_location(<span class="va">self</span>):</span>
<span id="cb21-13"><a href=""></a>        <span class="va">self</span>.location <span class="op">=</span> uniform(<span class="dv">0</span>, <span class="dv">1</span>), uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb21-14"><a href=""></a></span>
<span id="cb21-15"><a href=""></a>    <span class="kw">def</span> get_distance(<span class="va">self</span>, other):</span>
<span id="cb21-16"><a href=""></a>        <span class="co">"Computes the euclidean distance between self and other agent."</span></span>
<span id="cb21-17"><a href=""></a>        a <span class="op">=</span> (<span class="va">self</span>.location[<span class="dv">0</span>] <span class="op">-</span> other.location[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb21-18"><a href=""></a>        b <span class="op">=</span> (<span class="va">self</span>.location[<span class="dv">1</span>] <span class="op">-</span> other.location[<span class="dv">1</span>])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb21-19"><a href=""></a>        <span class="cf">return</span> sqrt(a <span class="op">+</span> b)</span>
<span id="cb21-20"><a href=""></a></span>
<span id="cb21-21"><a href=""></a>    <span class="kw">def</span> happy(<span class="va">self</span>,</span>
<span id="cb21-22"><a href=""></a>                agents,                <span class="co"># List of other agents</span></span>
<span id="cb21-23"><a href=""></a>                num_neighbors<span class="op">=</span><span class="dv">10</span>,      <span class="co"># No. of agents viewed as neighbors</span></span>
<span id="cb21-24"><a href=""></a>                require_same_type<span class="op">=</span><span class="dv">3</span>):  <span class="co"># How many neighbors must be same type</span></span>
<span id="cb21-25"><a href=""></a>        <span class="co">"""</span></span>
<span id="cb21-26"><a href=""></a><span class="co">            True if a sufficient number of nearest neighbors are of the same</span></span>
<span id="cb21-27"><a href=""></a><span class="co">            type.</span></span>
<span id="cb21-28"><a href=""></a><span class="co">        """</span></span>
<span id="cb21-29"><a href=""></a></span>
<span id="cb21-30"><a href=""></a>        distances <span class="op">=</span> []</span>
<span id="cb21-31"><a href=""></a></span>
<span id="cb21-32"><a href=""></a>        <span class="co"># Distances is a list of pairs (d, agent), where d is distance from</span></span>
<span id="cb21-33"><a href=""></a>        <span class="co"># agent to self</span></span>
<span id="cb21-34"><a href=""></a>        <span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb21-35"><a href=""></a>            <span class="cf">if</span> <span class="va">self</span> <span class="op">!=</span> agent:</span>
<span id="cb21-36"><a href=""></a>                distance <span class="op">=</span> <span class="va">self</span>.get_distance(agent)</span>
<span id="cb21-37"><a href=""></a>                distances.append((distance, agent))</span>
<span id="cb21-38"><a href=""></a></span>
<span id="cb21-39"><a href=""></a>        <span class="co"># Sort from smallest to largest, according to distance</span></span>
<span id="cb21-40"><a href=""></a>        distances.sort()</span>
<span id="cb21-41"><a href=""></a></span>
<span id="cb21-42"><a href=""></a>        <span class="co"># Extract the neighboring agents</span></span>
<span id="cb21-43"><a href=""></a>        neighbors <span class="op">=</span> [agent <span class="cf">for</span> d, agent <span class="kw">in</span> distances[:num_neighbors]]</span>
<span id="cb21-44"><a href=""></a></span>
<span id="cb21-45"><a href=""></a>        <span class="co"># Count how many neighbors have the same type as self</span></span>
<span id="cb21-46"><a href=""></a>        num_same_type <span class="op">=</span> <span class="bu">sum</span>(<span class="va">self</span>.<span class="bu">type</span> <span class="op">==</span> agent.<span class="bu">type</span> <span class="cf">for</span> agent <span class="kw">in</span> neighbors)</span>
<span id="cb21-47"><a href=""></a>        <span class="cf">return</span> num_same_type <span class="op">&gt;=</span> require_same_type</span>
<span id="cb21-48"><a href=""></a></span>
<span id="cb21-49"><a href=""></a>    <span class="kw">def</span> update(<span class="va">self</span>, agents, num_neighbors<span class="op">=</span><span class="dv">10</span>, require_same_type<span class="op">=</span><span class="dv">3</span>):</span>
<span id="cb21-50"><a href=""></a>        <span class="co">"If not happy, then randomly choose new locations until happy."</span></span>
<span id="cb21-51"><a href=""></a>        <span class="cf">while</span> <span class="kw">not</span> <span class="va">self</span>.happy(agents, num_neighbors, require_same_type):</span>
<span id="cb21-52"><a href=""></a>            <span class="va">self</span>.draw_location()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">write a plotting function with white individuals represented by orange dots and black ones represented by green dots</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href=""></a><span class="kw">def</span> collect_distribution(agents):</span>
<span id="cb22-2"><a href=""></a>    <span class="co">"""Collect x, y coordinates for each agent type."""</span></span>
<span id="cb22-3"><a href=""></a>    x_values_0, y_values_0 <span class="op">=</span> [], []</span>
<span id="cb22-4"><a href=""></a>    x_values_1, y_values_1 <span class="op">=</span> [], []</span>
<span id="cb22-5"><a href=""></a>    <span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb22-6"><a href=""></a>        x, y <span class="op">=</span> agent.location</span>
<span id="cb22-7"><a href=""></a>        <span class="cf">if</span> agent.<span class="bu">type</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb22-8"><a href=""></a>            x_values_0.append(x)</span>
<span id="cb22-9"><a href=""></a>            y_values_0.append(y)</span>
<span id="cb22-10"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb22-11"><a href=""></a>            x_values_1.append(x)</span>
<span id="cb22-12"><a href=""></a>            y_values_1.append(y)</span>
<span id="cb22-13"><a href=""></a>    <span class="cf">return</span> x_values_0, y_values_0, x_values_1, y_values_1</span>
<span id="cb22-14"><a href=""></a></span>
<span id="cb22-15"><a href=""></a></span>
<span id="cb22-16"><a href=""></a><span class="kw">def</span> plot_side_by_side(initial_data, final_data, cycle_num):</span>
<span id="cb22-17"><a href=""></a>    <span class="co">"""Plot initial and final distributions side by side."""</span></span>
<span id="cb22-18"><a href=""></a>    fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb22-19"><a href=""></a>    plot_args <span class="op">=</span> {<span class="st">'markersize'</span>: <span class="dv">8</span>, <span class="st">'alpha'</span>: <span class="fl">0.6</span>}</span>
<span id="cb22-20"><a href=""></a></span>
<span id="cb22-21"><a href=""></a>    <span class="co"># Initial distribution</span></span>
<span id="cb22-22"><a href=""></a>    ax1.set_facecolor(<span class="st">'azure'</span>)</span>
<span id="cb22-23"><a href=""></a>    ax1.plot(initial_data[<span class="dv">0</span>], initial_data[<span class="dv">1</span>], <span class="st">'o'</span>, markerfacecolor<span class="op">=</span><span class="st">'orange'</span>, <span class="op">**</span>plot_args)</span>
<span id="cb22-24"><a href=""></a>    ax1.plot(initial_data[<span class="dv">2</span>], initial_data[<span class="dv">3</span>], <span class="st">'o'</span>, markerfacecolor<span class="op">=</span><span class="st">'green'</span>, <span class="op">**</span>plot_args)</span>
<span id="cb22-25"><a href=""></a>    ax1.set_title(<span class="st">'Initial Distribution (Cycle 0)'</span>)</span>
<span id="cb22-26"><a href=""></a>    ax1.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb22-27"><a href=""></a>    ax1.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb22-28"><a href=""></a></span>
<span id="cb22-29"><a href=""></a>    <span class="co"># Final distribution</span></span>
<span id="cb22-30"><a href=""></a>    ax2.set_facecolor(<span class="st">'azure'</span>)</span>
<span id="cb22-31"><a href=""></a>    ax2.plot(final_data[<span class="dv">0</span>], final_data[<span class="dv">1</span>], <span class="st">'o'</span>, markerfacecolor<span class="op">=</span><span class="st">'orange'</span>, <span class="op">**</span>plot_args)</span>
<span id="cb22-32"><a href=""></a>    ax2.plot(final_data[<span class="dv">2</span>], final_data[<span class="dv">3</span>], <span class="st">'o'</span>, markerfacecolor<span class="op">=</span><span class="st">'green'</span>, <span class="op">**</span>plot_args)</span>
<span id="cb22-33"><a href=""></a>    ax2.set_title(<span class="ss">f'Final Distribution (Cycle </span><span class="sc">{</span>cycle_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb22-34"><a href=""></a>    ax2.set_xlabel(<span class="st">'X'</span>)</span>
<span id="cb22-35"><a href=""></a>    ax2.set_ylabel(<span class="st">'Y'</span>)</span>
<span id="cb22-36"><a href=""></a></span>
<span id="cb22-37"><a href=""></a>    plt.tight_layout()</span>
<span id="cb22-38"><a href=""></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">Now we can run the simulation</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href=""></a><span class="kw">def</span> run_simulation(num_of_type_0<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb23-2"><a href=""></a>                   num_of_type_1<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb23-3"><a href=""></a>                   max_iter<span class="op">=</span><span class="dv">100000</span>,       <span class="co"># Maximum number of iterations</span></span>
<span id="cb23-4"><a href=""></a>                   set_seed<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb23-5"><a href=""></a>                   num_neighbors<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb23-6"><a href=""></a>                   require_same_type<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb23-7"><a href=""></a></span>
<span id="cb23-8"><a href=""></a>    <span class="co"># Set the seed for reproducibility</span></span>
<span id="cb23-9"><a href=""></a>    seed(set_seed)</span>
<span id="cb23-10"><a href=""></a></span>
<span id="cb23-11"><a href=""></a>    <span class="co"># Create a list of agents of type 0</span></span>
<span id="cb23-12"><a href=""></a>    agents <span class="op">=</span> [Agent(<span class="dv">0</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_of_type_0)]</span>
<span id="cb23-13"><a href=""></a>    <span class="co"># Append a list of agents of type 1</span></span>
<span id="cb23-14"><a href=""></a>    agents.extend(Agent(<span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_of_type_1))</span>
<span id="cb23-15"><a href=""></a></span>
<span id="cb23-16"><a href=""></a>    <span class="co"># Collect initial distribution</span></span>
<span id="cb23-17"><a href=""></a>    initial_data <span class="op">=</span> collect_distribution(agents)</span>
<span id="cb23-18"><a href=""></a>    </span>
<span id="cb23-19"><a href=""></a>    <span class="co"># Initialize a counter</span></span>
<span id="cb23-20"><a href=""></a>    count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb23-21"><a href=""></a></span>
<span id="cb23-22"><a href=""></a>    <span class="co"># Loop until no agent wishes to move</span></span>
<span id="cb23-23"><a href=""></a>    <span class="cf">while</span> count <span class="op">&lt;</span> max_iter:</span>
<span id="cb23-24"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f'Entering loop </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb23-25"><a href=""></a>        count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb23-26"><a href=""></a>        no_one_moved <span class="op">=</span> <span class="va">True</span></span>
<span id="cb23-27"><a href=""></a>        <span class="cf">for</span> agent <span class="kw">in</span> agents:</span>
<span id="cb23-28"><a href=""></a>            old_location <span class="op">=</span> agent.location</span>
<span id="cb23-29"><a href=""></a>            agent.update(agents, num_neighbors, require_same_type)</span>
<span id="cb23-30"><a href=""></a>            <span class="cf">if</span> agent.location <span class="op">!=</span> old_location:</span>
<span id="cb23-31"><a href=""></a>                no_one_moved <span class="op">=</span> <span class="va">False</span></span>
<span id="cb23-32"><a href=""></a>        <span class="cf">if</span> no_one_moved:</span>
<span id="cb23-33"><a href=""></a>            <span class="cf">break</span></span>
<span id="cb23-34"><a href=""></a></span>
<span id="cb23-35"><a href=""></a>    <span class="co"># Collect final distribution</span></span>
<span id="cb23-36"><a href=""></a>    final_data <span class="op">=</span> collect_distribution(agents)</span>
<span id="cb23-37"><a href=""></a></span>
<span id="cb23-38"><a href=""></a>    <span class="co"># Plot initial and final distributions side by side</span></span>
<span id="cb23-39"><a href=""></a>    plot_side_by_side(initial_data, final_data, count)</span>
<span id="cb23-40"><a href=""></a></span>
<span id="cb23-41"><a href=""></a>    <span class="cf">if</span> count <span class="op">&lt;</span> max_iter:</span>
<span id="cb23-42"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f'Converged after </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss"> iterations.'</span>)</span>
<span id="cb23-43"><a href=""></a>    <span class="cf">else</span>:</span>
<span id="cb23-44"><a href=""></a>        <span class="bu">print</span>(<span class="st">'Hit iteration bound and terminated.'</span>)</span>
<span id="cb23-45"><a href=""></a>        </span>
<span id="cb23-46"><a href=""></a>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li class="fragment">try running the simulation with different numbers of agents</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href=""></a><span class="co"># Run the simulation with example parameters</span></span>
<span id="cb24-2"><a href=""></a>run_simulation(</span>
<span id="cb24-3"><a href=""></a>    num_of_type_0<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb24-4"><a href=""></a>    num_of_type_1<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb24-5"><a href=""></a>    max_iter<span class="op">=</span><span class="dv">100000</span>,</span>
<span id="cb24-6"><a href=""></a>    set_seed<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb24-7"><a href=""></a>    num_neighbors<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb24-8"><a href=""></a>    require_same_type<span class="op">=</span><span class="dv">5</span>  <span class="co"># Example: require 5 neighbors of the same type</span></span>
<span id="cb24-9"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Entering loop 1
Entering loop 2
Entering loop 3
Entering loop 4
Entering loop 5
Entering loop 6
Entering loop 7
Converged after 8 iterations.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-26-1.png" width="960"></a></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section>
<section id="o-ring-theory" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>O-ring theory</h1>

</section>
<section id="o-ring-theory-1" class="slide level2">
<h2>O-ring theory</h2>
<ul>
<li class="fragment">The O-ring theory of economic development was proposed in 1993 by Michael Kremer, who was awarded the 2019 Nobel Prize in Economic Sciences for his work on economic growth and development (along with Esther Duflo and Abhijit Banerjee)</li>
<li class="fragment">The theory is based on the idea that the multiplicative nature of production in tasks require high-quality inputs working together
<ul>
<li class="fragment">The theory is named after the O-ring, a critical component in the Space Shuttle Challenger that failed in 1986, leading to the shuttle’s explosion shortly after launch</li>
</ul></li>
<li class="fragment">firms combine inputs (e.g., workers’ skills) in a way that the failure or lower quality of one input significantly reduces output
<ul>
<li class="fragment">The theory suggests that countries with low average skill levels may not be able to produce high-quality goods, as the risk of failure in one task can lead to overall poor performance</li>
<li class="fragment">O-rings in a spaceship where one weak link can cause catastrophic failure</li>
<li class="fragment">this leads to assortative matching, where high-skill workers cluster together, amplifying income disparities</li>
</ul></li>
</ul>
</section>
<section id="simulating-the-o-ring-theory" class="slide level2">
<h2>Simulating the O-ring theory</h2>
<ul>
<li class="fragment"><p>models workers with slightly skewed ability distributions</p>
<ul>
<li class="fragment">assigns them to firms based on skill levels</li>
<li class="fragment">calculates output using an O-ring production function</li>
</ul></li>
<li class="fragment"><p>Goal: The simulation shows how even modest ability differences can lead to significant income inequality</p></li>
<li class="fragment"><p>Some setting</p></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-3"><a href=""></a></span>
<span id="cb26-4"><a href=""></a><span class="co"># Parameters</span></span>
<span id="cb26-5"><a href=""></a>n_workers <span class="op">=</span> <span class="dv">1000</span>  <span class="co"># Number of workers</span></span>
<span id="cb26-6"><a href=""></a>n_firms <span class="op">=</span> <span class="dv">100</span>     <span class="co"># Number of firms</span></span>
<span id="cb26-7"><a href=""></a></span>
<span id="cb26-8"><a href=""></a>workers_per_firm <span class="op">=</span> n_workers <span class="op">//</span> n_firms</span>
<span id="cb26-9"><a href=""></a></span>
<span id="cb26-10"><a href=""></a>alpha <span class="op">=</span> <span class="fl">0.8</span>       <span class="co"># O-ring production function parameter (0 &lt; alpha &lt; 1)</span></span>
<span id="cb26-11"><a href=""></a>sigma <span class="op">=</span> <span class="fl">0.2</span>       <span class="co"># Standard deviation for ability distribution (small skew)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
</div>
</section>
<section id="key-steps" class="slide level2">
<h2>Key Steps</h2>
<ul>
<li class="fragment">Step 1: Generate worker abilities (log-normal for slight skew)</li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href=""></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb27-2"><a href=""></a>abilities <span class="op">=</span> np.random.lognormal(mean<span class="op">=</span><span class="dv">0</span>, sigma<span class="op">=</span>sigma, size<span class="op">=</span>n_workers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment">Step 2: Sort workers by ability and assign to firms (assortative matching)</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href=""></a>sorted_indices <span class="op">=</span> np.argsort(abilities)[::<span class="op">-</span><span class="dv">1</span>]  <span class="co"># Sort in descending order</span></span>
<span id="cb28-2"><a href=""></a>sorted_abilities <span class="op">=</span> abilities[sorted_indices]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment">Assign workers to firms: top workers to firm 1, next to firm 2, etc.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href=""></a>firm_abilities <span class="op">=</span> sorted_abilities.reshape(n_firms, workers_per_firm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
</div>
</section>
<section id="key-steps-continued" class="slide level2">
<h2>Key Steps (continued)</h2>
<ul>
<li class="fragment">Step 3: O-ring production function
<ul>
<li class="fragment">let output is <span class="math inline">\(Y\)</span></li>
<li class="fragment">Notice that <span class="math inline">\(Y = A * (\prod^n_{i=1} a_i)^\alpha\)</span>, where A is a constant (set to 1)</li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href=""></a>firm_outputs <span class="op">=</span> np.prod(firm_abilities, axis<span class="op">=</span><span class="dv">1</span>) <span class="op">**</span> alpha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment">Step 4: Assume wages are proportional to firm output
<ul>
<li class="fragment">Each worker in a firm earns a wage proportional to the firm’s output</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href=""></a></span>
<span id="cb31-2"><a href=""></a>wages <span class="op">=</span> np.repeat(firm_outputs, workers_per_firm) <span class="op">/</span> workers_per_firm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment">Step 5: Calculate income inequality (Gini coefficient)</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href=""></a></span>
<span id="cb32-2"><a href=""></a><span class="kw">def</span> gini_coefficient(incomes):</span>
<span id="cb32-3"><a href=""></a>    n <span class="op">=</span> <span class="bu">len</span>(incomes)</span>
<span id="cb32-4"><a href=""></a>    sorted_incomes <span class="op">=</span> np.sort(incomes)</span>
<span id="cb32-5"><a href=""></a>    cumulative_income <span class="op">=</span> np.cumsum(sorted_incomes)</span>
<span id="cb32-6"><a href=""></a>    <span class="co"># Lorenz curve area</span></span>
<span id="cb32-7"><a href=""></a>    lorenz_area <span class="op">=</span> np.<span class="bu">sum</span>(cumulative_income) <span class="op">/</span> (n <span class="op">*</span> cumulative_income[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb32-8"><a href=""></a>    <span class="co"># Gini = (Area between line of equality and Lorenz curve) / (Area under line of equality)</span></span>
<span id="cb32-9"><a href=""></a>    gini <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> lorenz_area</span>
<span id="cb32-10"><a href=""></a>    <span class="cf">return</span> gini</span>
<span id="cb32-11"><a href=""></a></span>
<span id="cb32-12"><a href=""></a>gini <span class="op">=</span> gini_coefficient(wages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
</div>
</section>
<section id="step-6-plot-the-distribution-of-wages-and-display-the-gini-coefficient" class="slide level2">
<h2>Step 6: Plot the distribution of wages and display the Gini coefficient</h2>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href=""></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb33-2"><a href=""></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-3"><a href=""></a></span>
<span id="cb33-4"><a href=""></a></span>
<span id="cb33-5"><a href=""></a><span class="co"># Set a modern style</span></span>
<span id="cb33-6"><a href=""></a>sns.set_style(<span class="st">"whitegrid"</span>)  <span class="co"># Adds a clean grid background</span></span>
<span id="cb33-7"><a href=""></a>plt.rcParams[<span class="st">'font.family'</span>] <span class="op">=</span> <span class="st">'Arial'</span>  <span class="co"># Use a clean, professional font</span></span>
<span id="cb33-8"><a href=""></a>plt.rcParams[<span class="st">'axes.titlesize'</span>] <span class="op">=</span> <span class="dv">14</span>  <span class="co"># Increase title font size</span></span>
<span id="cb33-9"><a href=""></a>plt.rcParams[<span class="st">'axes.labelsize'</span>] <span class="op">=</span> <span class="dv">12</span>  <span class="co"># Increase label font size</span></span>
<span id="cb33-10"><a href=""></a>plt.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">10</span>  <span class="co"># Adjust tick label size</span></span>
<span id="cb33-11"><a href=""></a>plt.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb33-12"><a href=""></a></span>
<span id="cb33-13"><a href=""></a><span class="co"># Create figure with a larger size for better visibility</span></span>
<span id="cb33-14"><a href=""></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">6</span>), facecolor<span class="op">=</span><span class="st">'white'</span>)</span>
<span id="cb33-15"><a href=""></a></span>
<span id="cb33-16"><a href=""></a><span class="co"># Plot ability distribution</span></span>
<span id="cb33-17"><a href=""></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb33-18"><a href=""></a>sns.histplot(abilities, bins<span class="op">=</span><span class="dv">50</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'#1f77b4'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, stat<span class="op">=</span><span class="st">'density'</span>, </span>
<span id="cb33-19"><a href=""></a>             edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-20"><a href=""></a>plt.title(<span class="ss">f'Ability Distribution</span><span class="ch">\n</span><span class="ss">(Mean=</span><span class="sc">{</span>np<span class="sc">.</span>mean(abilities)<span class="sc">:.2f}</span><span class="ss">, Std=</span><span class="sc">{</span>np<span class="sc">.</span>std(abilities)<span class="sc">:.2f}</span><span class="ss">)'</span>, </span>
<span id="cb33-21"><a href=""></a>          fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb33-22"><a href=""></a>plt.xlabel(<span class="st">'Ability'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-23"><a href=""></a>plt.ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-24"><a href=""></a></span>
<span id="cb33-25"><a href=""></a><span class="co"># Add mean line</span></span>
<span id="cb33-26"><a href=""></a>plt.axvline(np.mean(abilities), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Mean'</span>)</span>
<span id="cb33-27"><a href=""></a>plt.legend()</span>
<span id="cb33-28"><a href=""></a></span>
<span id="cb33-29"><a href=""></a><span class="co"># Plot wage distribution</span></span>
<span id="cb33-30"><a href=""></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb33-31"><a href=""></a>sns.histplot(wages, bins<span class="op">=</span><span class="dv">50</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">'#2ca02c'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, stat<span class="op">=</span><span class="st">'density'</span>, </span>
<span id="cb33-32"><a href=""></a>             edgecolor<span class="op">=</span><span class="st">'black'</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb33-33"><a href=""></a>plt.title(<span class="ss">f'Wage Distribution</span><span class="ch">\n</span><span class="ss">(Gini Coefficient=</span><span class="sc">{</span>gini<span class="sc">:.3f}</span><span class="ss">)'</span>, </span>
<span id="cb33-34"><a href=""></a>          fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb33-35"><a href=""></a>plt.xlabel(<span class="st">'Wage'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-36"><a href=""></a>plt.ylabel(<span class="st">'Density'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb33-37"><a href=""></a></span>
<span id="cb33-38"><a href=""></a><span class="co"># Add median line</span></span>
<span id="cb33-39"><a href=""></a>plt.axvline(np.median(wages), color<span class="op">=</span><span class="st">'purple'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="st">'Median'</span>)</span>
<span id="cb33-40"><a href=""></a>plt.legend()</span>
<span id="cb33-41"><a href=""></a></span>
<span id="cb33-42"><a href=""></a><span class="co"># Adjust layout and add a subtle background color</span></span>
<span id="cb33-43"><a href=""></a>plt.tight_layout()</span>
<span id="cb33-44"><a href=""></a>plt.suptitle(<span class="st">'Distribution Analysis'</span>, fontsize<span class="op">=</span><span class="dv">16</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">1.05</span>)</span>
<span id="cb33-45"><a href=""></a>plt.gcf().set_facecolor(<span class="st">'#f5f5f5'</span>)  <span class="co"># Light gray background for the figure</span></span>
<span id="cb33-46"><a href=""></a></span>
<span id="cb33-47"><a href=""></a><span class="co"># Show plot</span></span>
<span id="cb33-48"><a href=""></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-37-1.png" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href=""></a><span class="co"># Print summary statistics</span></span>
<span id="cb34-2"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Ability: Mean=</span><span class="sc">{</span>np<span class="sc">.</span>mean(abilities)<span class="sc">:.2f}</span><span class="ss">, Std=</span><span class="sc">{</span>np<span class="sc">.</span>std(abilities)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ability: Mean=1.02, Std=0.20</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Wages: Mean=</span><span class="sc">{</span>np<span class="sc">.</span>mean(wages)<span class="sc">:.2f}</span><span class="ss">, Std=</span><span class="sc">{</span>np<span class="sc">.</span>std(wages)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Wages: Mean=0.36, Std=0.91</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href=""></a><span class="bu">print</span>(<span class="ss">f"Gini Coefficient: </span><span class="sc">{</span>gini<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Gini Coefficient: 0.738</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="social-network-analysis" class="title-slide slide level1 center" data-visibility="uncounted">
<h1>Social Network Analysis</h1>

</section>
<section id="social-network" class="slide level2">
<h2>Social Network</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb40-2"><a href=""></a><span class="do">## load the data</span></span>
<span id="cb40-3"><a href=""></a></span>
<span id="cb40-4"><a href=""></a>follow <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/kwan-MSDA/FOSS/refs/heads/main/twitter-following.csv"</span>)</span>
<span id="cb40-5"><a href=""></a></span>
<span id="cb40-6"><a href=""></a>senator <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/kwan-MSDA/FOSS/refs/heads/main/twitter-senator.csv"</span>)</span>
<span id="cb40-7"><a href=""></a><span class="do">## examine</span></span>
<span id="cb40-8"><a href=""></a><span class="fu">head</span>(follow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  following    followed       
  &lt;chr&gt;        &lt;chr&gt;          
1 SenAlexander RoyBlunt       
2 SenAlexander SenatorBurr    
3 SenAlexander JohnBoozman    
4 SenAlexander SenJohnBarrasso
5 SenAlexander SenBennetCO    
6 SenAlexander SenDanCoats    </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="fu">head</span>(senator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  screen_name     name            party state
  &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;
1 SenAlexander    Lamar Alexander R     TN   
2 RoyBlunt        Roy Blunt       R     MO   
3 SenatorBoxer    Barbara Boxer   D     CA   
4 SenSherrodBrown Sherrod Brown   D     OH   
5 SenatorBurr     Richard Burr    R     NC   
6 SenatorBaldwin  Tammy Baldwin   D     WI   </code></pre>
</div>
</div>
</section>
<section id="building-the-twitter-network" class="slide level2">
<h2>Building the Twitter Network</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a><span class="fu">library</span>(igraph)</span>
<span id="cb44-2"><a href=""></a></span>
<span id="cb44-3"><a href=""></a>twitter_adj <span class="ot">&lt;-</span> <span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(follow),</span>
<span id="cb44-4"><a href=""></a>                                   <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-5"><a href=""></a></span>
<span id="cb44-6"><a href=""></a></span>
<span id="cb44-7"><a href=""></a>senator <span class="ot">&lt;-</span> <span class="fu">mutate</span>(senator,</span>
<span id="cb44-8"><a href=""></a>         <span class="at">indegree =</span> <span class="fu">degree</span>(twitter_adj, <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb44-9"><a href=""></a>         <span class="at">outdegree =</span> <span class="fu">degree</span>(twitter_adj, <span class="at">mode =</span> <span class="st">"out"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href=""></a><span class="fu">arrange</span>(senator, <span class="fu">desc</span>(indegree)) <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href=""></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href=""></a>  <span class="fu">select</span>(name, party, state, indegree, outdegree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  name              party state indegree outdegree
  &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Tom Cotton        R     AR          64        15
2 Richard J. Durbin D     IL          60        87
3 John Barrasso     R     WY          58        79</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="do">## with slice_max</span></span>
<span id="cb47-2"><a href=""></a><span class="fu">slice_max</span>(senator, <span class="at">order_by =</span> indegree, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href=""></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(indegree)) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href=""></a>  <span class="fu">select</span>(name, party, state, indegree, outdegree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  name              party state indegree outdegree
  &lt;chr&gt;             &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 Tom Cotton        R     AR          64        15
2 Richard J. Durbin D     IL          60        87
3 John Barrasso     R     WY          58        79
4 Joe Donnelly      D     IN          58         9
5 Orrin G. Hatch    R     UT          58        50</code></pre>
</div>
</div>
</div>
</section>
<section id="some-key-measures-for-network" class="slide level2">
<h2>Some key measures for network</h2>
<ul>
<li class="fragment">define scales to reuse for the plots</li>
</ul>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a>scale_color_parties <span class="ot">&lt;-</span> <span class="fu">scale_color_manual</span>(<span class="st">"Party"</span>,</span>
<span id="cb49-2"><a href=""></a>                                           <span class="at">values =</span> <span class="fu">c</span>(<span class="at">R =</span> <span class="st">"red"</span>,</span>
<span id="cb49-3"><a href=""></a>                                                       <span class="at">D =</span> <span class="st">"blue"</span>,</span>
<span id="cb49-4"><a href=""></a>                                                       <span class="at">I =</span> <span class="st">"green"</span>),</span>
<span id="cb49-5"><a href=""></a>                                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">R =</span> <span class="st">"Republican"</span>,</span>
<span id="cb49-6"><a href=""></a>                                                     <span class="at">D=</span> <span class="st">"Democrat"</span>,</span>
<span id="cb49-7"><a href=""></a>                                                     <span class="at">I =</span> <span class="st">"Independent"</span>))</span>
<span id="cb49-8"><a href=""></a>scale_shape_parties <span class="ot">&lt;-</span> <span class="fu">scale_shape_manual</span>(<span class="st">"Party"</span>,</span>
<span id="cb49-9"><a href=""></a>                                          <span class="at">values =</span> <span class="fu">c</span>(<span class="at">R =</span> <span class="dv">16</span>,</span>
<span id="cb49-10"><a href=""></a>                                                     <span class="at">D =</span> <span class="dv">17</span>,</span>
<span id="cb49-11"><a href=""></a>                                                     <span class="at">I =</span> <span class="dv">4</span>),</span>
<span id="cb49-12"><a href=""></a>                                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="at">R =</span> <span class="st">"Republican"</span>,</span>
<span id="cb49-13"><a href=""></a>                                                     <span class="at">D=</span> <span class="st">"Democrat"</span>,</span>
<span id="cb49-14"><a href=""></a>                                                     <span class="at">I =</span> <span class="st">"Independent"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">

</div>
<ul>
<li class="fragment">Calculate closeness measures and graph</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href=""></a>senator <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">closeness_in =</span> <span class="fu">closeness</span>(twitter_adj,</span>
<span id="cb50-3"><a href=""></a>                                          <span class="at">mode =</span> <span class="st">"in"</span>),</span>
<span id="cb50-4"><a href=""></a>         <span class="at">closeness_out =</span> <span class="fu">closeness</span>(twitter_adj,</span>
<span id="cb50-5"><a href=""></a>                                           <span class="at">mode =</span> <span class="st">"out"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> closeness_in, <span class="at">y =</span> closeness_out,</span>
<span id="cb50-7"><a href=""></a>             <span class="at">color =</span> party, <span class="at">shape =</span> party)) <span class="sc">+</span></span>
<span id="cb50-8"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-9"><a href=""></a>  scale_color_parties <span class="sc">+</span></span>
<span id="cb50-10"><a href=""></a>  scale_shape_parties <span class="sc">+</span></span>
<span id="cb50-11"><a href=""></a>  <span class="fu">labs</span>(<span class="at">main =</span> <span class="st">"Closeness"</span>, <span class="at">x =</span> <span class="st">"Incoming path"</span>,</span>
<span id="cb50-12"><a href=""></a>       <span class="at">y =</span> <span class="st">"Outgoing path"</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href=""></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href=""></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-44-1.png" width="1152"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment">Calculate betweenness measures and graph</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a>senator <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">betweenness_dir =</span> <span class="fu">betweenness</span>(twitter_adj,</span>
<span id="cb51-3"><a href=""></a>                                               <span class="at">directed =</span> <span class="cn">TRUE</span>),</span>
<span id="cb51-4"><a href=""></a>         <span class="at">betweenness_undir =</span> <span class="fu">betweenness</span>(twitter_adj,</span>
<span id="cb51-5"><a href=""></a>                                                 <span class="at">directed =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> betweenness_dir,</span>
<span id="cb51-7"><a href=""></a>             <span class="at">y =</span> betweenness_undir, <span class="at">color =</span> party,</span>
<span id="cb51-8"><a href=""></a>             <span class="at">shape =</span> party)) <span class="sc">+</span></span>
<span id="cb51-9"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href=""></a>  scale_color_parties <span class="sc">+</span></span>
<span id="cb51-11"><a href=""></a>  scale_shape_parties <span class="sc">+</span></span>
<span id="cb51-12"><a href=""></a>  <span class="fu">labs</span>(<span class="at">main =</span> <span class="st">"Betweenness"</span>, <span class="at">x =</span> <span class="st">"Directed"</span>, <span class="at">y =</span> <span class="st">"Undirected"</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href=""></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-45-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-45-1.png" width="1152"></a></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment">Calculate the pagerank</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a>senator <span class="ot">&lt;-</span> <span class="fu">mutate</span>(senator,</span>
<span id="cb52-2"><a href=""></a>                  <span class="at">page_rank =</span> <span class="fu">page_rank</span>(twitter_adj)[[<span class="st">"vector"</span>]])</span>
<span id="cb52-3"><a href=""></a></span>
<span id="cb52-4"><a href=""></a><span class="do">## Create igraph object</span></span>
<span id="cb52-5"><a href=""></a>net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> follow,</span>
<span id="cb52-6"><a href=""></a>                             <span class="at">vertices =</span> senator,</span>
<span id="cb52-7"><a href=""></a>                             <span class="at">directed=</span>T)</span>
<span id="cb52-8"><a href=""></a><span class="do">## View the new object</span></span>
<span id="cb52-9"><a href=""></a>net</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH ab8cb45 DN-- 91 3859 -- 
+ attr: name (v/c), party (v/c), state (v/c), indegree (v/n), outdegree
| (v/n), page_rank (v/n)
+ edges from ab8cb45 (vertex names):
 [1] Lamar Alexander-&gt;Roy Blunt         Lamar Alexander-&gt;Richard Burr     
 [3] Lamar Alexander-&gt;John Boozman      Lamar Alexander-&gt;John Barrasso    
 [5] Lamar Alexander-&gt;Michael F. Bennet Lamar Alexander-&gt;Daniel Coats     
 [7] Lamar Alexander-&gt;Susan M. Collins  Lamar Alexander-&gt;John Cornyn      
 [9] Lamar Alexander-&gt;Bob Corker        Lamar Alexander-&gt;Michael B. Enzi  
[11] Lamar Alexander-&gt;Joni Ernst        Lamar Alexander-&gt;Chuck Grassley   
[13] Lamar Alexander-&gt;Cory Gardner      Lamar Alexander-&gt;Orrin G. Hatch   
+ ... omitted several edges</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a><span class="do">## look at some network edges, nodes, and node (vertex) attributes</span></span>
<span id="cb54-2"><a href=""></a><span class="fu">head</span>(<span class="fu">E</span>(net)) <span class="do">## E() for edges</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>+ 6/3859 edges from ab8cb45 (vertex names):
[1] Lamar Alexander-&gt;Roy Blunt         Lamar Alexander-&gt;Richard Burr     
[3] Lamar Alexander-&gt;John Boozman      Lamar Alexander-&gt;John Barrasso    
[5] Lamar Alexander-&gt;Michael F. Bennet Lamar Alexander-&gt;Daniel Coats     </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="fu">head</span>(<span class="fu">V</span>(net)) <span class="do">## V() for vertex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>+ 6/91 vertices, named, from ab8cb45:
[1] Lamar Alexander Roy Blunt       Barbara Boxer   Sherrod Brown  
[5] Richard Burr    Tammy Baldwin  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="fu">head</span>(<span class="fu">V</span>(net)<span class="sc">$</span>party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R" "R" "D" "D" "R" "D"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a><span class="do">## Create igraph object</span></span>
<span id="cb60-2"><a href=""></a>net <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> follow,</span>
<span id="cb60-3"><a href=""></a>                             <span class="at">vertices =</span> senator,</span>
<span id="cb60-4"><a href=""></a>                             <span class="at">directed=</span>T)</span>
<span id="cb60-5"><a href=""></a><span class="do">## View the new object</span></span>
<span id="cb60-6"><a href=""></a>net</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>IGRAPH ab8f3f8 DN-- 91 3859 -- 
+ attr: name (v/c), party (v/c), state (v/c), indegree (v/n), outdegree
| (v/n), page_rank (v/n)
+ edges from ab8f3f8 (vertex names):
 [1] Lamar Alexander-&gt;Roy Blunt         Lamar Alexander-&gt;Richard Burr     
 [3] Lamar Alexander-&gt;John Boozman      Lamar Alexander-&gt;John Barrasso    
 [5] Lamar Alexander-&gt;Michael F. Bennet Lamar Alexander-&gt;Daniel Coats     
 [7] Lamar Alexander-&gt;Susan M. Collins  Lamar Alexander-&gt;John Cornyn      
 [9] Lamar Alexander-&gt;Bob Corker        Lamar Alexander-&gt;Michael B. Enzi  
[11] Lamar Alexander-&gt;Joni Ernst        Lamar Alexander-&gt;Chuck Grassley   
[13] Lamar Alexander-&gt;Cory Gardner      Lamar Alexander-&gt;Orrin G. Hatch   
+ ... omitted several edges</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href=""></a><span class="do">## look at some network edges, nodes, and node (vertex) attributes</span></span>
<span id="cb62-2"><a href=""></a><span class="fu">head</span>(<span class="fu">E</span>(net)) <span class="do">## E() for edges</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>+ 6/3859 edges from ab8f3f8 (vertex names):
[1] Lamar Alexander-&gt;Roy Blunt         Lamar Alexander-&gt;Richard Burr     
[3] Lamar Alexander-&gt;John Boozman      Lamar Alexander-&gt;John Barrasso    
[5] Lamar Alexander-&gt;Michael F. Bennet Lamar Alexander-&gt;Daniel Coats     </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href=""></a><span class="fu">head</span>(<span class="fu">V</span>(net)) <span class="do">## V() for vertex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>+ 6/91 vertices, named, from ab8f3f8:
[1] Lamar Alexander Roy Blunt       Barbara Boxer   Sherrod Brown  
[5] Richard Burr    Tammy Baldwin  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href=""></a><span class="fu">head</span>(<span class="fu">V</span>(net)<span class="sc">$</span>party)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R" "R" "D" "D" "R" "D"</code></pre>
</div>
</div>
</div>
</section>
<section id="plot-the-network" class="slide level2">
<h2>Plot the network</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href=""></a><span class="co"># Identify top 5 senators by PageRank for each party</span></span>
<span id="cb68-2"><a href=""></a>top5_by_party <span class="ot">&lt;-</span> senator <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href=""></a>  <span class="fu">group_by</span>(party) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href=""></a>  <span class="fu">top_n</span>(<span class="dv">5</span>, page_rank) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href=""></a>  <span class="fu">arrange</span>(party, <span class="fu">desc</span>(page_rank)) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href=""></a>  <span class="fu">select</span>(name, party, page_rank)  <span class="co"># Assuming 'name' is the column with senator names</span></span>
<span id="cb68-7"><a href=""></a></span>
<span id="cb68-8"><a href=""></a><span class="co"># Create a vector of labels, defaulting to NA</span></span>
<span id="cb68-9"><a href=""></a><span class="fu">V</span>(net)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb68-10"><a href=""></a></span>
<span id="cb68-11"><a href=""></a><span class="co"># Assign labels for the top 5 senators per party</span></span>
<span id="cb68-12"><a href=""></a><span class="co"># Match senator names from top5_by_party to vertex names in the network</span></span>
<span id="cb68-13"><a href=""></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(top5_by_party)) {</span>
<span id="cb68-14"><a href=""></a>  vertex_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(net)<span class="sc">$</span>name <span class="sc">==</span> top5_by_party<span class="sc">$</span>name[i])  <span class="co"># Adjust 'name' to your vertex ID column</span></span>
<span id="cb68-15"><a href=""></a>  <span class="cf">if</span> (<span class="fu">length</span>(vertex_idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb68-16"><a href=""></a>    <span class="fu">V</span>(net)<span class="sc">$</span>label[vertex_idx] <span class="ot">&lt;-</span> top5_by_party<span class="sc">$</span>name[i]</span>
<span id="cb68-17"><a href=""></a>  }</span>
<span id="cb68-18"><a href=""></a>}</span>
<span id="cb68-19"><a href=""></a></span>
<span id="cb68-20"><a href=""></a><span class="do">## Vector of colors of the nodes based on party</span></span>
<span id="cb68-21"><a href=""></a>col <span class="ot">&lt;-</span> senator <span class="sc">%&gt;%</span></span>
<span id="cb68-22"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">case_when</span>(party <span class="sc">==</span> <span class="st">"R"</span> <span class="sc">~</span> <span class="st">"red"</span>,</span>
<span id="cb68-23"><a href=""></a>                         party <span class="sc">==</span> <span class="st">"D"</span> <span class="sc">~</span> <span class="st">"blue"</span>,</span>
<span id="cb68-24"><a href=""></a>                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href=""></a>  <span class="fu">select</span>(col) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb68-26"><a href=""></a></span>
<span id="cb68-27"><a href=""></a><span class="co"># Plot the network with labels for top 5 per party</span></span>
<span id="cb68-28"><a href=""></a><span class="fu">plot</span>(net, </span>
<span id="cb68-29"><a href=""></a>     <span class="at">vertex.size =</span> <span class="fu">V</span>(net)<span class="sc">$</span>page_rank <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb68-30"><a href=""></a>     <span class="at">vertex.label =</span> <span class="fu">V</span>(net)<span class="sc">$</span>label,  <span class="co"># Use the new label attribute</span></span>
<span id="cb68-31"><a href=""></a>     <span class="at">vertex.label.cex =</span> <span class="fl">0.8</span>,       <span class="co"># Adjust label size</span></span>
<span id="cb68-32"><a href=""></a>     <span class="at">vertex.label.color =</span> <span class="st">"black"</span>, <span class="co"># Label color</span></span>
<span id="cb68-33"><a href=""></a>     <span class="at">vertex.color =</span> col,</span>
<span id="cb68-34"><a href=""></a>     <span class="at">edge.arrow.size =</span> <span class="fl">0.1</span>,</span>
<span id="cb68-35"><a href=""></a>     <span class="at">edge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb68-36"><a href=""></a>     <span class="at">main =</span> <span class="st">"Twitter Network of US Senators (Top 5 PageRank Labeled)"</span>,</span>
<span id="cb68-37"><a href=""></a>     <span class="at">layout =</span> <span class="fu">layout_with_kk</span>(net, <span class="at">niter =</span> <span class="dv">1000</span>))</span>
<span id="cb68-38"><a href=""></a></span>
<span id="cb68-39"><a href=""></a><span class="co"># Add a legend for party colors</span></span>
<span id="cb68-40"><a href=""></a><span class="fu">legend</span>(<span class="st">"topright"</span>,  <span class="co"># Position of the legend (adjust as needed: "topleft", "bottomright", etc.)</span></span>
<span id="cb68-41"><a href=""></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Other"</span>),</span>
<span id="cb68-42"><a href=""></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"black"</span>),</span>
<span id="cb68-43"><a href=""></a>       <span class="at">pch =</span> <span class="dv">19</span>,  <span class="co"># Solid circle symbol for nodes</span></span>
<span id="cb68-44"><a href=""></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="co"># No box around legend</span></span>
<span id="cb68-45"><a href=""></a>       <span class="at">cex =</span> <span class="fl">0.8</span>) <span class="co"># Adjust legend text size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fragment">
<div class="cell-output-display">
<div>
<figure>
<p><a href="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="CSS-Workshop_revised4_files/figure-revealjs/unnamed-chunk-47-1.png" width="1152"></a></p>
</figure>
</div>
</div>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="CSS Workshop_revised4_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":null,"id":"4611338c17d0adce","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: false,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 3.0e-2,

        maxScale: 2,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>